<!--
  Submit Post Page - Gator Garage Web Application

  This EJS template facilitates the submission of new posts on the Gator Garage platform. It includes a detailed form for inputting post data, a live preview of the uploaded image, and integrates essential partials for consistent navigation and footer.
-->

<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('./partials/head') %>
    <style>
      .card-body img {
        width: 150px;
        /* Adjust as needed */
        height: 150px;
        /* Adjust as needed */
        object-fit: cover;
        /* This will ensure that the image covers the entire area of the img element without distorting the aspect ratio */
      }
    </style>
</head>

<body>
  <%- include('./partials/nav') %>
  <div id="page-content" style="min-height: 100vh;" class="container text-center border-dark mt-5">
    <!-- Page Content -->
    <h2 class="mb-5 display-5 mt-3">Submit a Post</h2>
    <div class="container row d-flex mt-5">
      <div class="col-md-6">
        <form class="submit-post-form" data-gtm-form-interact-id="0">
          <div class="mb-3">
            <label for="title" class="form-label">Title*</label>
            <input type="text" id="title" name="title" required="" <="" div="" data-gtm-form-interact-field-id="1" class="form-control mb-3 is-invalid" placeholder="Enter Title here...">
            <div class="mb-3">
              <label for="course" class="form-label">Course</label>
              <input type="text" class="form-control" id="course" name="course" placeholder="Ex: CSC 648">
            </div>
            <div class="mb-3">
              <label for="category" class="form-label">Category*</label>
              <input type="text" class="form-control is-invalid" id="category" name="category" required="" data-gtm-form-interact-field-id="2" placeholder="Ex: Books">
            </div>
            <div class="mb-3">
              <label for="price" class="form-label">Price*</label>
              <input type="number" class="form-control is-invalid" id="price" name="price" required="" data-gtm-form-interact-field-id="0">
            </div>
            <div class="mb-3">
              <label for="location" class="form-label">Location*</label>
              <select class="form-control is-invalid" id="location" name="location" required="" data-gtm-form-interact-field-id="1" onchange="toggleOtherInput()">
                  <option value="">Select Location</option>
                  <option value="Administration">Administration</option>
                  <option value="Business">Business</option>
                  <option value="Cesar Chavez Student Center">Cesar Chavez Student Center</option>
                  <option value="Creative Arts Building">Creative Arts Building</option>
                  <option value="J. Paul Leonard Library">J. Paul Leonard Library</option>
                  <option value="Science Building">Science Building</option>
                  <option value="Fine Arts Building">Fine Arts Building</option>
                  <option value="Ethnic Studies & Psychology Building">Ethnic Studies & Psychology Building</option>
                  <option value="Hensill Hall">Hensill Hall</option>
                  <option value="Burk Hall">Burk Hall</option>
                  <option value="Humanities Building">Humanities Building</option>
                  <option value="Other">Other</option>
              </select>
          </div>
          <div class="mb-3 d-none" id="otherLocationDiv">
              <label for="otherLocation" class="form-label">Other Location</label>
              <input type="text" class="form-control" id="otherLocation" name="otherLocation" placeholder="Enter Your Location">
          </div>          
            <div class="mb-3">
              <label for="description" class="form-label">Description*</label>
              <textarea class="form-control is-invalid" id="description" name="description" rows="3" required="" data-gtm-form-interact-field-id="0" placeholder="Enter your compelling description here..."></textarea>
            </div>
            <div class="mb-3">
              <label for="image" class="form-label">Upload Image*</label>
              <input type="file" class="form-control" id="image" name="image" data-gtm-form-interact-field-id="0" required="">
            </div>
            <button type="submit" class="btn btn-primary w-50">Submit</button>
          </div>
        </form>
      </div>
      <div class="col">
        <div class="mb-3">
          <div class="display-5 mb-3 mt-3">Preview Image</div>
          <!-- TODO : might not work in production , need to check how it handles images -->
          <img src="blob:http://localhost:3000/2109260d-90d3-4815-9179-50e143832049" alt="Upload image to show preview" id="preview-image" width="300" height="300" class="preview-image img-fluid border border-dark">
        </div>
      </div>
    </div>
  </div>
    <%- include('./partials/footer') %>
      <script>
        // script for showing image
        document.getElementById('image').addEventListener('change', function (event) {
          const preview = document.getElementById('preview-image');
          preview.src = URL.createObjectURL(event.target.files[0]);
        });

        // script for showing other location field when "Other" is selected
        function toggleOtherInput() {
          var locationSelect = document.getElementById("location");
          var otherLocationDiv = document.getElementById("otherLocationDiv");
          var otherLocationInput = document.getElementById("otherLocation");
          
          if (locationSelect.value === "Other") {
              otherLocationDiv.classList.remove("d-none");
              otherLocationInput.required = true;
          } else {
              otherLocationDiv.classList.add("d-none");
              otherLocationInput.required = false;
              otherLocationInput.value = ""; // Clear any previous input
          }
    }
      </script>
</body>

</html>